#!/sbin/openrc-run
# OpenRC init script for Grafana
# Generated by Ansible - do not edit manually

description="Grafana visualization and monitoring platform"
command="{{ grafana_bin_dir }}/grafana"
command_args="server --homepath={{ grafana_data_dir }} --config={{ grafana_config_dir }}/grafana.ini"
command_user="{{ grafana_user }}:{{ grafana_group }}"
directory="{{ grafana_data_dir }}"
pidfile="/run/grafana.pid"
logfile="{{ grafana_log_dir }}/grafana.log"

depend() {
	need net
	after firewall
}

start() {
	ebegin "Starting Grafana"
	start-stop-daemon --start \
		--user "$command_user" \
		--pidfile "$pidfile" \
		--background \
		--make-pidfile \
		--stdout "$logfile" \
		--stderr "$logfile" \
		--exec $command \
		-- $command_args
	eend $?
}

stop() {
	ebegin "Stopping Grafana"
	start-stop-daemon --stop \
		--pidfile "$pidfile" \
		--exec $command
	eend $?
}

restart() {
	stop
	sleep 1
	start
}
